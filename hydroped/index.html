<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Hydro-PED: Hydro-PED Reservoir Stimulation Simulator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li class="current"><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Hydro-PED Reservoir Stimulation Simulator</h1><dl class="author"><dt><b>Author:</b></dt><dd>Vladimir Lyakhovsky </dd>
<dd>
Eyal Shalev </dd>
<dd>
Harel Levin </dd>
<dd>
Gal Oren </dd></dl>
<h2><a class="anchor" id="About">
About</a></h2>
<p>HydroPED Simulation program was originally developed by Vladimir Lyakhovsky Eyal Shalev from the Geological Survey of Israel. The program performs modeling of hydraulic stimulation by welbore fluid injection. It combines physical aspects of rock mechanics and fluid diffusion. Currently, there is an ongoing efforts to make the hydrology component more efficiently, and to integrate a new component to the model which will add the aspects of heat advection. </p>
<h2><a class="anchor" id="Introduction">
Introduction</a></h2>
<p>Hydro-PED is built out of two wings which calculates the cross-effects between the rock and the fluids. The part of rock mechanics was developed mainly by Vladimir. This code is based on his former researches which enabled the development of the commercial application called FLAC (Fast Lagrangian Analysis of Continuous). The hydrology part was developed by Eyal. It calculates diffusion using the Finite Elements Method, which translates the problem to linear equation of type Ax=b where A is a sparse positive symmetric matrix, b is a known vector, and x is the variables vector. The two wings of the program, are calculated over the same grid but their timesteps may be varied. The mechanics of the rock causes changes in the structure of the rock, which in turn changes the velocity of the reservoir, which influences the fluid's stress and flow, which changes the forces that work over the rock and so on and so forth. Another part of the model, which is currently in development, is the heat model. </p>
<dl class="user"><dt><b></b></dt><dd>The following graph expresses the connections between the different modules. Let $V$ stand for volume, <img class="formulaInl" alt="$k$" src="form_20.png"/> is permeability, <img class="formulaInl" alt="$v_f$" src="form_21.png"/> is flow velocity, <img class="formulaInl" alt="$\rho$" src="form_22.png"/> is density and <img class="formulaInl" alt="$\mu$" src="form_23.png"/> is viscosity. <div align="center">
<img src="inline_dotgraph_1.dot.png" alt="inline_dotgraph_1.dot" border="0" usemap="#inline_dotgraph_1.dot.map">
<map name="inline_dotgraph_1.dot.map" id="inline_dotgraph_1.dot.map"></map>
</div>
</dd></dl>
<p>The dominant approach when integrating various physical modules, is to make some iterations for every timestep, which enables us to iteratively make the solution more accurate. For instance, we can set a wanted accuracy level of fluid's density <img class="formulaInl" alt="$\Delta \rho$" src="form_24.png"/> and make all the calculations, in all program's modules, over and over until at some iteration <img class="formulaInl" alt="$n+1$" src="form_25.png"/> we will achieve <img class="formulaInl" alt="$\lVert \rho_{n+1} - \rho_{n} \rVert \leq \Delta \rho $" src="form_26.png"/>. In Hydro-PED we assume that because the timesteps were calculated such that the cahnge in physical parameters will be minimal, as will be explained later, we can neglect the iterative improvement. The new values of the physical parameters will spread to the next timestep.</p>
<h2><a class="anchor" id="mechanics">
Rock Mechanics Module</a></h2>
<p>The mechanical component of the program solves directly the equations of rock mechanincs in a direct and extremely efficient method. The timestep is adaptive and sometimes it can be in the resolution of a microsecond. <br/>
 The timestep is calculated as follows. We set the balance of the system as <img class="formulaInl" alt="$\frac{\sum F} {max{\left|F\right|}}$" src="form_27.png"/> where <img class="formulaInl" alt="$F$" src="form_28.png"/> is the forces in the system. As much as the sum of the forces is smaller, the system is more balanced. Whenever the balance is smaller than a pre-defined value, the timestep will be increased by some factor, and vice-versa, when the balance is bigger than some other value, which is referred as "off-balance" (boff), the timestep will be decreased by the same factor. In geological systems, there are no drastic changes without any continuous progress, which is why there is no need to dramatically change the value of the timestep, and an adaptive approach is more appropriate. The values of the off-balance and the increase (respectively decrease) factor can be determined only by a trial and error process, according to the material which the system is made of. However, In a case where the rock is broke up, the timestep will jump down to the minimum value, as will be described later. <br/>
 The module is representing the system's space using tetrahedrons where each one is referred as an "element" every vertex of the tetrahedron is referred as a "node". Some of the physical calculations are performed over an element, and some of them over a node. There are reciprocal relations between an element and his corresponding nodes. For example, the total mass of an element is divided equally to four such that it contributes quarter of element's mass to each node's mass. Each node is shared between four elements, so node's total mass is the average masses of all his corresponding elements. <br/>
 Stress creates strain. The strain is reflected by changing the place of the nodes of the different elements. This change creates deformation of the elements. In general, the calculation of the strain is performed by a three-dimensional velocity vector which set the place of the nodes after the strain. This velocity is determined by a combination of the force over the node and a damper which creates an opposite force and tend to balance the system (just like friction). The sum of the forces which influences a node, <img class="formulaInl" alt="$\vec{F}$" src="form_29.png"/>, combined with Frequency Independent Damping force which is determined by a preconditioner <img class="formulaInl" alt="$demf \in \left[0,1\right]$" src="form_30.png"/> which produces the net force <img class="formulaInl" alt="$\vec{F}^*=\vec{F}-demf\cdot \vec{F}$" src="form_31.png"/>. The velocity of each node is then calculated <img class="formulaInl" alt="$v^+=v^-+\frac{\vec{F}^*}{m}\cdot \Delta t$" src="form_32.png"/>. Now, using the calculated velcity, the coordinates of each node are re-calculated. </p>
<dl class="user"><dt><b></b></dt><dd>The following figure depicts a deforamtion of a tetrahedron. The blue color describes the structure of the element before the strain, and the red color is the same tetrahedron after the strain. <div align="center">
<img src="deformation.svg" alt="deformation.svg"/>
</div>
</dd></dl>
<p>In one dimensional space, the strain of a <img class="formulaInl" alt="$l$" src="form_33.png"/>-long spring, which becomes <img class="formulaInl" alt="$\Delta l$" src="form_34.png"/> is calculated by <img class="formulaInl" alt="$\varepsilon = \frac{\Delta l}{l}$" src="form_35.png"/>. In three-dimensional space, the strain is represented by a tensor: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{bmatrix} \varepsilon_{xx} &amp; \varepsilon_{xy} &amp; \varepsilon_{xz} \\ \varepsilon_{yx} &amp; \varepsilon_{yy} &amp; \varepsilon_{yz} \\ \varepsilon_{dx} &amp; \varepsilon_{dy} &amp; \varepsilon_{dz} \end{bmatrix} = \begin{bmatrix} \frac{\partial{u_x}}{\partial{x}} &amp; \frac{1}{2}\left(\frac{\partial{u_x}}{\partial{y}} + \frac{\partial{u_y}}{\partial{x}}\right) &amp; \frac{1}{2}\left(\frac{\partial{u_x}}{\partial{z}} + \frac{\partial{u_z}}{\partial{x}}\right) \\ \frac{1}{2}\left(\frac{\partial{u_y}}{\partial{x}} + \frac{\partial{u_x}}{\partial{y}}\right) &amp; \frac{\partial{u_y}}{\partial{y}} &amp; \frac{1}{2}\left(\frac{\partial{u_y}}{\partial{z}} + \frac{\partial{u_z}}{\partial{y}}\right) \\ \frac{1}{2}\left(\frac{\partial{u_z}}{\partial{x}} + \frac{\partial{u_x}}{\partial{z}}\right) &amp; \frac{1}{2}\left(\frac{\partial{u_z}}{\partial{y}} + \frac{\partial{u_y}}{\partial{z}}\right) &amp; \frac{\partial{u_z}}{\partial{z}} \end{bmatrix} \]" src="form_36.png"/>
</p>
<p>The elements in the main diagonal are called Volumetric (or Bulk) Modulus. The rest of the elements are called Shear Modulus. <br/>
 Based on the strain, we use Hooke's law to calculate the force over the body. In one-dimensional space, Hooke's law states that <img class="formulaInl" alt="$F=k\cdot \varepsilon$" src="form_37.png"/>. In three-dimensional space, Hooke's law sets up a linear function <img class="formulaInl" alt="$\Phi$" src="form_38.png"/> such that <img class="formulaInl" alt="$\sigma=\Phi(\varepsilon)$" src="form_39.png"/>. <br/>
 At that point, the damage mechanics field of research is getting involved. When a rock is being stressed up, it starts to create more and more fatigue, micro-cracks, which getting bigger as much as the stress keep being applied or gets stronger. The amount of damage is noted as <img class="formulaInl" alt="$\alpha \in [0,1] $" src="form_40.png"/> where <img class="formulaInl" alt="$\alpha=0$" src="form_41.png"/> means an ideal material, without any fatigue, and <img class="formulaInl" alt="$\alpha=1$" src="form_42.png"/> means a break up of the rock. The updated Hooke's law is considering the damage of the rock so now <img class="formulaInl" alt="$\sigma=\Phi \left(\varepsilon, \alpha \right) $" src="form_43.png"/>. The next step is to calculate the force over each face. For a given normal vector <img class="formulaInl" alt="$\vec{n}=\begin{pmatrix}n_x &amp; n_y &amp; n_z\end{pmatrix}$" src="form_44.png"/> the force will be </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\begin{bmatrix} F_1 \\ F_2 \\ F_3 \end{bmatrix}=\begin{bmatrix} \sigma_{xx} &amp; \sigma_{xy} &amp; \sigma_{xz} \\ \sigma_{yx} &amp; \sigma_{yy} &amp; \sigma_{yz} \\ \sigma_{zx} &amp; \sigma_{zy} &amp; \sigma_{zz} \end{bmatrix}\begin{bmatrix}n_x \\ n_y \\ n_z \end{bmatrix}\]" src="form_45.png"/>
</p>
<p> From the calculation decribed above we get the following data flow: stress creates strain, which in turn effects the stress and so on and so forth. Another factor in this process is the evaluation of the state of the material. Whenever the rock is breaking up, the strain will continue to deform the elements even without any force investment. From that point on the finite elemnts method is not usable anymore because the computation will not converge. FLAC method, however, will work as usual. <br/>
 Whenever a break-up event has occured, the process performs actions in order to put the system in a balanced state once again. These actions, which defines a healing process, are coded in the "drop" subroutine. In the case of a well, the healing process is performed by fluids which seeps between the cracks, which decrease the stress inside the well and the gravity force is repairing the rock. <br/>
 Sometimes, parts of the strain are irrevrsible. As in the case of heated plasticine clay. This strain is referred as irrevrsible strain or plastic strain. When we calculate the force using Hooke's law, we should consider only the reversible (elastic) part of the strain. In general we can state that <img class="formulaInl" alt="$\varepsilon_{total}=\varepsilon_{plastic}+\varepsilon_{elastic}$" src="form_46.png"/>.</p>
<h2><a class="anchor" id="hydrology">
Hydrology Module</a></h2>
<p>Whereas mechanics chages in the rock occure sometimes in a frequent manner, fluids changes are relatively less frequent. For this reason, the hydrology timestep is never less than 10 seconds. However, when the system is in such blalanced state that the mechanics timestep is bigger than 10 seconds, the hydrology timestep will get his value from the mechanics timestep. The same goes to the heat module. In this way, the hydrology and head modules have an implicit adaptive timestep. <br/>
 The hydrology module solves the differential equation: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[S_\varepsilon\frac{\partial{p}}{\partial{t}}=\nabla\frac{k}{\mu}\nabla p+\alpha_B \frac{\partial{\varepsilon}}{\partial{t}}\]" src="form_47.png"/>
</p>
<p> The equations are being solved by finite elements method such that we should find vector <img class="formulaInl" alt="$\vec{x}$" src="form_48.png"/> which represents the stress in the rock at the next timestep based on matrix <img class="formulaInl" alt="$k$" src="form_20.png"/> which represents the state of the rock in terms of permeability and strain, and vector <img class="formulaInl" alt="$\vec{F}$" src="form_29.png"/> which represents the stress at the current timestep. We get the linear algebra equation: <img class="formulaInl" alt="$k\times\vec{x}=\vec{F}$" src="form_49.png"/>. <br/>
 First of all, we calculate matrix <img class="formulaInl" alt="$k_i$" src="form_50.png"/> and vector <img class="formulaInl" alt="$\vec{F_i}$" src="form_51.png"/> for each element <img class="formulaInl" alt="$i$" src="form_52.png"/> using the "tetra" subroutine. each matrix <img class="formulaInl" alt="$k_i$" src="form_50.png"/> is of size <img class="formulaInl" alt="$4\time4$" src="form_53.png"/> because it represents teh relations between element's nodes. Then, the program build the overall matrix <img class="formulaInl" alt="$k$" src="form_20.png"/> and vector <img class="formulaInl" alt="$\vec{F}$" src="form_29.png"/> such that each row and column represents specific node. <br/>
 From the description above it is easy to figure out that matrix <img class="formulaInl" alt="$k$" src="form_20.png"/> is extremely sparse because every node has relations with at most another 12 nodes. Additionally, the matrix is symmetric because the diffusion effect is symmetric for each pair of nodes. The combination of these two characteristics points out that itertive solution methods should be very effective.</p>
<h2><a class="anchor" id="heat">
Heat Advection Module</a></h2>
<p>The solution of the hydrology equations <img class="formulaInl" alt="$FLUX=K_p\nabla P$" src="form_54.png"/> leads to a sparse, positive, symmetric matrix. The solution of heat transfer equations leads to a sparse matrix, but asymmetric one. The cause to this difference is the fact that in the aspect of heat there are two components. The first component, diffusion is common to both heat and hydrology. The second component is heat advection where materials with mass performs tarnsition of heat on themselves. This component is moving in a specific direction and so effects the structure of the matrix asymmetrically. The equations the module should solve have the form of <img class="formulaInl" alt="$ FLUX=K_T\nabla T+advection$" src="form_55.png"/>. <br/>
 As mentioned above, the timestep of the heat module is the smae as the hydrology timestep. <br/>
 The temperature is calculated by the equation: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \rho c_P \frac{\partial{T}}{\partial{t}}=\nabla \left(K_T \nabla T \right) + v_i \nabla T \]" src="form_56.png"/>
</p>
<p> Where <img class="formulaInl" alt="$\rho$" src="form_22.png"/> stands for fluid's density, <img class="formulaInl" alt="$c_P$" src="form_57.png"/> is the heat capacity, <img class="formulaInl" alt="$K_T$" src="form_58.png"/> is heat preconditioner. The density of the fluid is influenced by fluid's pressure which is calculated by: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial{P}}{\partial{t}}=\nabla\left(\frac{K_P}{\mu}\nabla P \right)+ \left(M\frac{\partial{V}}{\partial{t}}\right)\]" src="form_59.png"/>
</p>
<p> Where <img class="formulaInl" alt="$V$" src="form_60.png"/> is the volume, <img class="formulaInl" alt="$P$" src="form_61.png"/> is the pressure, <img class="formulaInl" alt="$K_P$" src="form_62.png"/> is the permeability of the material and <img class="formulaInl" alt="$\mu$" src="form_23.png"/> is its viscosity. <br/>
 As we mentioned, the heat module is currently under development. </p>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 25 Jul 2019 for Hydro-PED by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
